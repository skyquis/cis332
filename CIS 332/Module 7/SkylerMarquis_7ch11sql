--==================================
--Skyler Marquis
--CIS332: Database and SQL
--Unit 6, Chapter 9 Assignment B
--==================================

--Chapter 11 - Create an SQL script with the solutions to the Hands-On problems 
--#1, #2, #3, #5, #6, #7, #8, #9 (skip #4 and #10) at the end of Chapter 11. 
--Be sure to use group functions for the solutions for Chapter 11.   Also, be 
--sure to assign alias names to display in the output so that the single-row 
--function doesn't appear as the heading.  The alias names in the displayed 
--results is required and worth points on this assignment.

--For #6, use the TO_CHAR function to format the output to currency rather than 
--a scientific number.

--Preparation for running the script
START "C:\Users\skyle\OneDrive\Documents\DMACC\CIS 332\Module 5\JLDB_Build_8.sql"
START "C:\Users\skyle\OneDrive\Documents\DMACC\CIS 332\Module 7\JLDB_Build_11.sql"

---#1 in hands on assignments
SELECT COUNT(title) as "Number of Cooking books"
 FROM books
 WHERE category = 'COOKING';
 
--#2
SELECT COUNT(title) as "Number of books with retail greater than $30"
 FROM books
 WHERE retail > 30;
 
--#3
SELECT MAX(pubdate) as "Most recent publication date"
 FROM books;
 
--#5
SELECT MIN(retail) as "Least expensive book in Computer category"
 FROM books
 WHERE category = 'COMPUTER';
 
--#6
SELECT AVG(SUM(quantity*(retail-cost))) as "Average profit generated by orders"
 FROM orders JOIN orderitems USING(order#) JOIN books USING(isbn)
 GROUP BY order#;
 
--#7
SELECT customer# as "Customer #", 
 COUNT(*) as "Number of Orders"
 FROM orders group by customer#;
 
--#8
SELECT name as "Publisher Name",
 category as "Category",
 AVG(retail) as "Average Retail Price"
 FROM books JOIN publisher USING(pubid)
 WHERE category IN('CHILDREN', 'COMPUTER')
 WHERE AVG(retail) > 50
 group by name, category;
 
--#9
